@model ShoppingCartModel.GiftCardBoxModel
@if (Model.Display)
{
    <div class="giftcard-box">
        <div class="title">
            <strong>@T("ShoppingCart.GiftCardCouponCode")</strong>
        </div>
        <div class="coupon-code">
            <div class="form-group">
                <span class="col-form-label">@T("ShoppingCart.GiftCardCouponCode.Tooltip")</span>
                <div class="input-group">
                    <input id="giftcardcouponcode" name="giftcardcouponcode" type="text" class="form-control gift-card-coupon-code" />
                    <label for="giftcardcouponcode" class="sr-only">@T("ShoppingCart.GiftCardCouponCode.Button")</label>
                    <span class="input-group-append">
                        <button type="button" name="applygiftcardcouponcode" id="applygiftcardcouponcode" onclick="ApplyGiftCard(this)" class="btn btn-outline-secondary apply-discount-coupon-code-button"
                                data-href="@Url.RouteUrl("ApplyGiftCard")">
                            @T("ShoppingCart.GiftCardCouponCode.Button")
                        </button>
                    </span>
                </div>
            </div>
        </div>
        @if (!String.IsNullOrEmpty(Model.Message))
        {
            <div class="alert @(Model.IsApplied ? "alert-success message-success" : "alert-danger message-failure") text-center">
                @Model.Message
            </div>
        }
    </div>
    <script asp-location="Footer">
        function ApplyGiftCard(e) {
            var href = e.getAttribute('data-href');
            var giftCardData = {
                giftcardcouponcode: document.getElementById('giftcardcouponcode').value,
            };
            addAntiForgeryToken(giftCardData);
            var bodyFormData = new FormData();
            bodyFormData.append('giftcardcouponcode', document.getElementById('giftcardcouponcode').value);
            bodyFormData.append('__RequestVerificationToken', document.querySelector('input[name=__RequestVerificationToken]').value);
            axios({
                method: 'post',
                url: href,
                data: bodyFormData,
                headers: {'Content-Type': 'multipart/form-data' }
            }).then(function (response) {
                document.querySelector('#ordersummarypagecart').innerHTML = response.data.cart;
                new Vue({
                    el: '.checkout-buttons',
                    mixins: [mix]
                });
                new Vue({
                    el: '.coupon-box'
                });
                checkoutAttributeChange();
            })
        }
    </script>
}